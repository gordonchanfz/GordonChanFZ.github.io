(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{1578:function(v,_,t){"use strict";t.r(_);var s=t(3),a=Object(s.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h3",{attrs:{id:"前言"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[v._v("#")]),v._v(" 前言")]),v._v(" "),_("p",[v._v("用户附近位置如何计算？")]),v._v(" "),_("p",[v._v("常见的很多app功能都有附近位置的计算，那是如何实现的？是通过两点经纬度距离计算？想快速了解附近100米的超市？遍历每个超市拿经纬度计算距离显然不合适。")]),v._v(" "),_("p",[v._v("经纬度与物理距离介绍"),_("br"),v._v("\n经纬度是经度与纬度的合称组成一个坐标系统，称为地理坐标系统，它是一种利用三度空间的球面来定义地球上的空间的球面坐标系统，能够标示地球上的任何一个位置。")]),v._v(" "),_("p",[_("img",{attrs:{src:t(617),alt:"img"}})]),v._v(" "),_("p",[v._v("在一定误差范围内，通常情况下，经纬线和米的换算为：经度或者纬度0.00001度，约等于1米。以下表格列出更细致的换算关系：")]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[v._v("在纬度相等的情况下")])]),v._v(" "),_("th",[_("strong",[v._v("在经度相等的情况下")])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("经度每隔0.00001度，距离相差约1米；每隔0.0001度，距离相差约10米；每隔0.001度，距离相差约100米；每隔0.01度，距离相差约1000米；每隔0.1度，距离相差约10000米。")]),v._v(" "),_("td",[v._v("纬度每隔0.00001度，距离相差约1.1米；每隔0.0001度，距离相差约11米；每隔0.001度，距离相差约111米；每隔0.01度，距离相差约1113米；每隔0.1度，距离相差约11132米。")])])])]),v._v(" "),_("h3",{attrs:{id:"geohash算法介绍"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#geohash算法介绍"}},[v._v("#")]),v._v(" Geohash算法介绍")]),v._v(" "),_("p",[v._v("GeoHash是"),_("strong",[v._v("空间索引")]),v._v("的一种方式，其基本原理是将地球理解为一个二维平面，通过把二维的空间经纬度数据编码为一个字符串，可以"),_("strong",[v._v("把平面递归分解成更小的子块，每个子块在一定经纬度范围内拥有相同的编码。")])]),v._v(" "),_("p",[v._v("以GeoHash方式建立空间索引，可以提高对空间poi数据进行经纬度检索的效率。")]),v._v(" "),_("p",[v._v("编码规则为：先将纬度范围(-90, 90)平分成两个区间(-90, 0)和(0, 90)，如果目标维度位于前一个区间，则编码为0，否则编码为1，然后根据目标纬度所落的区间再平均分成两个区间进行编码，以此类推，直到精度满足要求，经度也用同样的算法，对(-180, 180)依次细分，然后合并经度和纬度的编码，"),_("strong",[v._v("奇数位放纬度，偶数位放经度")]),v._v("，组成一串新的二进制编码，按照"),_("strong",[v._v("Base32")]),v._v("进行编码。")]),v._v(" "),_("p",[_("strong",[v._v("示例")])]),v._v(" "),_("p",[v._v("以当前所在办公区【两江国际】的位置坐标为例, "),_("strong",[v._v("经纬度为（104.059684，30.559545）")])]),v._v(" "),_("h3",{attrs:{id:"第一步-将经纬度转换为二进制"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#第一步-将经纬度转换为二进制"}},[v._v("#")]),v._v(" 第一步：将经纬度转换为二进制")]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[v._v("序号")])]),v._v(" "),_("th",[_("strong",[v._v("纬度范围")])]),v._v(" "),_("th",[_("strong",[v._v("划分区间0")])]),v._v(" "),_("th",[_("strong",[v._v("划分区间1")])]),v._v(" "),_("th",[_("strong",[v._v("30.559545所属区间")])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("1")]),v._v(" "),_("td",[v._v("(-90, 90)")]),v._v(" "),_("td",[v._v("(-90, 0.0)")]),v._v(" "),_("td",[v._v("(0.0, 90)")]),v._v(" "),_("td",[v._v("1")])]),v._v(" "),_("tr",[_("td",[v._v("2")]),v._v(" "),_("td",[v._v("(0.0, 90)")]),v._v(" "),_("td",[v._v("(0.0, 45.0)")]),v._v(" "),_("td",[v._v("(45.0, 90)")]),v._v(" "),_("td",[v._v("0")])]),v._v(" "),_("tr",[_("td",[v._v("3")]),v._v(" "),_("td",[v._v("(0.0, 45.0)")]),v._v(" "),_("td",[v._v("(0.0, 22.5)")]),v._v(" "),_("td",[v._v("(22.5, 45.0)")]),v._v(" "),_("td",[v._v("1")])]),v._v(" "),_("tr",[_("td",[v._v("4")]),v._v(" "),_("td",[v._v("(22.5, 45.0)")]),v._v(" "),_("td",[v._v("(22.5, 33.75)")]),v._v(" "),_("td",[v._v("(33.75, 45.0)")]),v._v(" "),_("td",[v._v("0")])]),v._v(" "),_("tr",[_("td",[v._v("5")]),v._v(" "),_("td",[v._v("(22.5, 33.75)")]),v._v(" "),_("td",[v._v("(22.5, 28.125)")]),v._v(" "),_("td",[v._v("(28.125, 33.75)")]),v._v(" "),_("td",[v._v("1")])]),v._v(" "),_("tr",[_("td",[v._v("6")]),v._v(" "),_("td",[v._v("(28.125, 33.75)")]),v._v(" "),_("td",[v._v("(28.125, 30.9375)")]),v._v(" "),_("td",[v._v("(30.9375, 33.75)")]),v._v(" "),_("td",[v._v("0")])]),v._v(" "),_("tr",[_("td",[v._v("7")]),v._v(" "),_("td",[v._v("(28.125, 30.9375)")]),v._v(" "),_("td",[v._v("(28.125, 29.53125)")]),v._v(" "),_("td",[v._v("(29.53125, 30.9375)")]),v._v(" "),_("td",[v._v("1")])]),v._v(" "),_("tr",[_("td",[v._v("8")]),v._v(" "),_("td",[v._v("(29.53125, 30.9375)")]),v._v(" "),_("td",[v._v("(29.53125, 30.234375)")]),v._v(" "),_("td",[v._v("(30.234375, 30.9375)")]),v._v(" "),_("td",[v._v("1")])]),v._v(" "),_("tr",[_("td",[v._v("9")]),v._v(" "),_("td",[v._v("(30.234375, 30.9375)")]),v._v(" "),_("td",[v._v("(30.234375, 30.5859375)")]),v._v(" "),_("td",[v._v("(30.5859375, 30.9375)")]),v._v(" "),_("td",[v._v("0")])]),v._v(" "),_("tr",[_("td",[v._v("10")]),v._v(" "),_("td",[v._v("(30.234375, 30.5859375)")]),v._v(" "),_("td",[v._v("(30.234375, 30.41015625)")]),v._v(" "),_("td",[v._v("(30.41015625, 30.5859375)")]),v._v(" "),_("td",[v._v("1")])]),v._v(" "),_("tr",[_("td",[v._v("11")]),v._v(" "),_("td",[v._v("(30.41015625, 30.5859375)")]),v._v(" "),_("td",[v._v("(30.41015625, 30.498046875)")]),v._v(" "),_("td",[v._v("(30.498046875, 30.5859375)")]),v._v(" "),_("td",[v._v("1")])]),v._v(" "),_("tr",[_("td",[v._v("12")]),v._v(" "),_("td",[v._v("(30.498046875, 30.5859375)")]),v._v(" "),_("td",[v._v("(30.498046875, 30.541992188)")]),v._v(" "),_("td",[v._v("(30.541992188, 30.5859375)")]),v._v(" "),_("td",[v._v("1")])]),v._v(" "),_("tr",[_("td",[v._v("13")]),v._v(" "),_("td",[v._v("(30.541992188, 30.5859375)")]),v._v(" "),_("td",[v._v("(30.541992188, 30.563964844)")]),v._v(" "),_("td",[v._v("(30.563964844, 30.5859375)")]),v._v(" "),_("td",[v._v("0")])]),v._v(" "),_("tr",[_("td",[v._v("14")]),v._v(" "),_("td",[v._v("(30.541992188, 30.563964844)")]),v._v(" "),_("td",[v._v("(30.541992188, 30.552978516)")]),v._v(" "),_("td",[v._v("(30.552978516, 30.563964844)")]),v._v(" "),_("td",[v._v("1")])]),v._v(" "),_("tr",[_("td",[v._v("15")]),v._v(" "),_("td",[v._v("(30.552978516, 30.563964844)")]),v._v(" "),_("td",[v._v("(30.552978516, 30.55847168)")]),v._v(" "),_("td",[v._v("(30.55847168, 30.563964844)")]),v._v(" "),_("td",[v._v("1")])])])]),v._v(" "),_("p",[v._v("最后得到维度的二进制编码为：101010110111011, 用同样的方式可以得到精度(104.059684)的二进制编码：110010011111111。")]),v._v(" "),_("h3",{attrs:{id:"第二步-将经纬度的二进制编码合并"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#第二步-将经纬度的二进制编码合并"}},[v._v("#")]),v._v(" "),_("strong",[v._v("第二步：将经纬度的二进制编码合并")])]),v._v(" "),_("p",[_("strong",[v._v("从偶数0开始，经度占偶数位，纬度占奇数位。")])]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[v._v("序号")])]),v._v(" "),_("th",[_("strong",[v._v("0")])]),v._v(" "),_("th",[_("strong",[v._v("1")])]),v._v(" "),_("th",[_("strong",[v._v("2")])]),v._v(" "),_("th",[_("strong",[v._v("3")])]),v._v(" "),_("th",[_("strong",[v._v("4")])]),v._v(" "),_("th",[_("strong",[v._v("5")])]),v._v(" "),_("th",[_("strong",[v._v("6")])]),v._v(" "),_("th",[_("strong",[v._v("7")])]),v._v(" "),_("th",[_("strong",[v._v("8")])]),v._v(" "),_("th",[_("strong",[v._v("9")])]),v._v(" "),_("th",[_("strong",[v._v("10")])]),v._v(" "),_("th",[_("strong",[v._v("11")])]),v._v(" "),_("th",[_("strong",[v._v("12")])]),v._v(" "),_("th",[_("strong",[v._v("13")])]),v._v(" "),_("th",[_("strong",[v._v("14")])]),v._v(" "),_("th",[_("strong",[v._v("15")])]),v._v(" "),_("th",[_("strong",[v._v("16")])]),v._v(" "),_("th",[_("strong",[v._v("17")])]),v._v(" "),_("th",[_("strong",[v._v("18")])]),v._v(" "),_("th",[_("strong",[v._v("19")])]),v._v(" "),_("th",[_("strong",[v._v("20")])]),v._v(" "),_("th",[_("strong",[v._v("21")])]),v._v(" "),_("th",[_("strong",[v._v("22")])]),v._v(" "),_("th",[_("strong",[v._v("23")])]),v._v(" "),_("th",[_("strong",[v._v("24")])]),v._v(" "),_("th",[_("strong",[v._v("25")])]),v._v(" "),_("th",[_("strong",[v._v("26")])]),v._v(" "),_("th",[_("strong",[v._v("27")])]),v._v(" "),_("th",[_("strong",[v._v("28")])]),v._v(" "),_("th",[_("strong",[v._v("29")])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[_("strong",[v._v("编码")])]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("0")]),v._v(" "),_("td",[v._v("0")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("0")]),v._v(" "),_("td",[v._v("0")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("0")]),v._v(" "),_("td",[v._v("0")]),v._v(" "),_("td",[v._v("0")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("0")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("0")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("1")])])])]),v._v(" "),_("h3",{attrs:{id:"第三步-将合并后的二进制数做base32编码"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#第三步-将合并后的二进制数做base32编码"}},[v._v("#")]),v._v(" 第三步：将合并后的二进制数做Base32编码")]),v._v(" "),_("p",[_("strong",[v._v("按照每5位一组，分成6组，每组计算其对应的十进制数值，按照Base32进行编码。")])]),v._v(" "),_("p",[v._v("Base32编码表的其中一种如下，是用0-9、b-z（去掉a, i, l, o）这32个字母进行编码.")]),v._v(" "),_("p",[_("img",{attrs:{src:t(618),alt:"image-20230315022500048"}})]),v._v(" "),_("div",{staticClass:"language-java line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-java"}},[_("code",[_("span",{pre:!0,attrs:{class:"token number"}},[v._v("11100")]),v._v(" "),_("span",{pre:!0,attrs:{class:"token number"}},[v._v("10011")]),v._v(" "),_("span",{pre:!0,attrs:{class:"token number"}},[v._v("00011")]),v._v(" "),_("span",{pre:!0,attrs:{class:"token number"}},[v._v("11011")]),v._v(" "),_("span",{pre:!0,attrs:{class:"token number"}},[v._v("11111")]),v._v(" "),_("span",{pre:!0,attrs:{class:"token number"}},[v._v("01111")]),v._v("\n"),_("span",{pre:!0,attrs:{class:"token function"}},[v._v("28")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("(")]),v._v("w"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(")")]),v._v(" "),_("span",{pre:!0,attrs:{class:"token function"}},[v._v("19")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("(")]),v._v("m"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(")")]),v._v(" "),_("span",{pre:!0,attrs:{class:"token function"}},[v._v("3")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("(")]),_("span",{pre:!0,attrs:{class:"token number"}},[v._v("3")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(")")]),v._v("  "),_("span",{pre:!0,attrs:{class:"token function"}},[v._v("27")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("(")]),v._v("v"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(")")]),v._v(" "),_("span",{pre:!0,attrs:{class:"token function"}},[v._v("31")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("(")]),v._v("z"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(")")]),v._v(" "),_("span",{pre:!0,attrs:{class:"token function"}},[v._v("15")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("(")]),v._v("g"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(")")]),v._v("\n")])]),v._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[v._v("1")]),_("br"),_("span",{staticClass:"line-number"},[v._v("2")]),_("br")])]),_("p",[_("strong",[v._v("最终得到的经纬度编码为：wm3vzg")])]),v._v(" "),_("p",[v._v("如上文二进制编码的计算过程，如果"),_("strong",[v._v("递归的次数越大，则生成的二进制编码越长")]),v._v("，因此生成的geohash编码越长，"),_("strong",[v._v("位置越精确")]),v._v("。目前"),_("strong",[v._v("Geohash")]),v._v("使用的精度说明如下：")]),v._v(" "),_("p",[_("img",{attrs:{src:t(619),alt:"img"}})]),v._v(" "),_("p",[v._v("GeoHash用一个字符串表示经度和纬度两个坐标, 比直接用经纬度的高效很多，而且使用者可以发布地址编码，既能表明自己位于某位置附近，又不至于暴露自己的精确坐标，有助于隐私保护。")]),v._v(" "),_("p",[_("strong",[v._v("编码过程中，通过二分范围匹配的方式来决定某个经纬坐标是编码为1还是0，因此某些邻近坐标的编码是相同的，因此GeoHash表示的并不是一个点，而是一个矩形区域。 GeoHash编码的前缀可以表示更大的区域。例如wm3vzg，它的前缀wm3vz表示包含编码wm3vzg在内的更大范围。 这个特性可以用于附近地点搜索。")])]),v._v(" "),_("h3",{attrs:{id:"网格与实际地理的精度"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#网格与实际地理的精度"}},[v._v("#")]),v._v(" 网格与实际地理的精度")]),v._v(" "),_("p",[v._v("如果把某个区域或整个地图上的地理位置都按照Geohash编码，则会得到一个网格，编码递归粒度越细，网格的矩形区域越小，geohash编码的长度越大，则Geohash编码越精确。 不同的编码长度，生成的网格与实际地理的精度如下(Geohash字符串编码长度对应网格大小）:")]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[v._v("字符串长度")])]),v._v(" "),_("th",[_("strong",[v._v("网格宽度")])]),v._v(" "),_("th",[_("strong",[v._v("网格高度")])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("1")]),v._v(" "),_("td",[v._v("5000Km")]),v._v(" "),_("td",[v._v("5000Km")])]),v._v(" "),_("tr",[_("td",[v._v("2")]),v._v(" "),_("td",[v._v("1250Km")]),v._v(" "),_("td",[v._v("625Km")])]),v._v(" "),_("tr",[_("td",[v._v("3")]),v._v(" "),_("td",[v._v("156Km")]),v._v(" "),_("td",[v._v("156Km")])]),v._v(" "),_("tr",[_("td",[v._v("4")]),v._v(" "),_("td",[v._v("39.1Km")]),v._v(" "),_("td",[v._v("19.5Km")])]),v._v(" "),_("tr",[_("td",[v._v("5")]),v._v(" "),_("td",[v._v("4.89Km")]),v._v(" "),_("td",[v._v("4.89Km")])]),v._v(" "),_("tr",[_("td",[_("strong",[v._v("6")])]),v._v(" "),_("td",[_("strong",[v._v("1.22Km")])]),v._v(" "),_("td",[_("strong",[v._v("0.61Km")])])]),v._v(" "),_("tr",[_("td",[_("strong",[v._v("7")])]),v._v(" "),_("td",[_("strong",[v._v("153m")])]),v._v(" "),_("td",[_("strong",[v._v("153m")])])]),v._v(" "),_("tr",[_("td",[_("strong",[v._v("8")])]),v._v(" "),_("td",[v._v("38.2m")]),v._v(" "),_("td",[_("strong",[v._v("19.1m")])])]),v._v(" "),_("tr",[_("td",[v._v("9")]),v._v(" "),_("td",[v._v("4.77m")]),v._v(" "),_("td",[v._v("4.77m")])]),v._v(" "),_("tr",[_("td",[v._v("10")]),v._v(" "),_("td",[v._v("1.19m")]),v._v(" "),_("td",[v._v("0.596m")])])])]),v._v(" "),_("p",[v._v("Geohash编码与网格")]),v._v(" "),_("p",[v._v("当前选取的编码长度为6，因此一个网格实际的地理差异在1.2公里与0.6公里，示例中两江国际对应的网格大致效果如图：")]),v._v(" "),_("p",[_("img",{attrs:{src:t(620),alt:"img"}})]),v._v(" "),_("h3",{attrs:{id:"使用geohash算法推算附近位置的弊端"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#使用geohash算法推算附近位置的弊端"}},[v._v("#")]),v._v(" 使用geohash算法推算附近位置的弊端")]),v._v(" "),_("p",[_("img",{attrs:{src:t(621),alt:"image-20230624011131681"}})]),v._v(" "),_("h3",{attrs:{id:"邻近-8个-网格位置推算"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#邻近-8个-网格位置推算"}},[v._v("#")]),v._v(" "),_("strong",[v._v("邻近(8个)网格位置推算")])]),v._v(" "),_("p",[_("strong",[v._v("结论")]),_("br"),v._v("\n根据Geohash的编码规则将经纬度分解到二进制，结合地理常识，**中心网格在南北（上下）方向上体现为纬度的变化，往北则维度的二进制加1，往南则维度的二进制减1，在东西（左右）方向上体现为经度的变化，往东则经度的二进制加1，往西则减1，**可以计算出上下左右四个网格经纬度的二进制编码，再将加减得出的经纬度两两组合，计算出左上、左下、右上和右下四个网格的经纬度二进制编码，从而就可以根据Geohash的编码规则计算出周围八个网格的字符串。")]),v._v(" "),_("h3",{attrs:{id:"正向推导"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#正向推导"}},[v._v("#")]),v._v(" 正向推导")]),v._v(" "),_("p",[v._v("以Geohash编码长度为6为基础，网格的宽高与实际距离换算为：1.2Km*0.6Km.")]),v._v(" "),_("p",[v._v("参考上文提到的，在经度相同情况下，每隔0.001度，距离相差约111米。0.6Km换算为纬度为：0.005405405。")]),v._v(" "),_("p",[v._v("当前两江国际粗粒度的wgs84坐标("),_("strong",[v._v("104.05503，30.562251),")]),v._v(" 纬度二进制编码：101010110111011，经度二进制编码：110010011111111, Geohash值为：wm3vzg")]),v._v(" "),_("p",[v._v("正北方向近邻的网格维度为增加一个网格的高度，即纬度增加0.005405405，为："),_("strong",[v._v("30.562251 +")]),v._v(" 0.005405405 = 30.567656405， 转换为二进制编码后为(可用工具快速转换)："),_("strong",[v._v("101010110111100")])]),v._v(" "),_("p",[_("strong",[v._v("正好是原纬度的二进制编码101010110111011 加1后的结果（101010110111011 + 000000000000001")]),v._v(" = "),_("strong",[v._v("101010110111100）")])]),v._v(" "),_("h3",{attrs:{id:"反向推导"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#反向推导"}},[v._v("#")]),v._v(" 反向推导")]),v._v(" "),_("p",[v._v("当前两江国际粗粒度的wgs84坐标("),_("strong",[v._v("104.05503，30.562251),")]),v._v(" 纬度二进制编码：101010110111011，经度二进制编码：110010011111111, Geohash值为：wm3vzg")]),v._v(" "),_("p",[v._v("基于当前坐标的网格，正北方向近邻的网格N，其纬度二进制加1后为：101010110111100，经度不变，其Geohash值为："),_("strong",[v._v("wm3vzu")])]),v._v(" "),_("p",[v._v("通过http://geohash.co/ 反向转换其经纬坐标为：(104.0570068359375,30.56671142578125）")]),v._v(" "),_("p",[v._v("通过https://www.box3.cn/tools/lbs.html 查询2个坐标的实际位置，误差在531m(符合精度范围）")]),v._v(" "),_("p",[_("img",{attrs:{src:t(622),alt:"img"}})]),v._v(" "),_("p",[v._v("邻近8个网格位置计算")]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[v._v("**"),_("em",[v._v("*Geohash编码：*"),_("em",[v._v("wm3vzs纬度二进制编码：101010110111100经度二进制编码：110010011111110公式：(Lat_bin + 1, Lon_bin - 1)")])])]),v._v(" "),_("th",[v._v("**"),_("em",[v._v("*Geohash编码：*"),_("em",[v._v("wm3vzu纬度二进制编码：101010110111100经度二进制编码：110100101101010公式：(Lat_bin + 1, Lon_bin)")])])]),v._v(" "),_("th",[v._v("**"),_("em",[v._v("*Geohash编码：*"),_("em",[v._v("wm6jbh纬度二进制编码：101010110111100经度二进制编码：110010100000000公式：(Lat_bin + 1, Lon_bin + 1)")])])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("**Geohash编码：**wm3vze纬度二进制编码：101010110111011经度二进制编码：110010011111110公式：(Lat_bin, Lon_bin - 1)")]),v._v(" "),_("td",[v._v("**Geohash编码：**wm3vzg纬度二进制编码：101010110111011经度二进制编码：110010011111111公式：(Lat_bin, Lon_bin)")]),v._v(" "),_("td",[v._v("**Geohash编码：**wm6jb5纬度二进制编码：101010110111011经度二进制编码：110010100000000公式：(Lat_bin, Lon_bin + 1)")])]),v._v(" "),_("tr",[_("td",[v._v("**Geohash编码：**wm3vzd纬度二进制编码：101010110111010经度二进制编码：110010011111110公式：(Lat_bin - 1, Lon_bin - 1)")]),v._v(" "),_("td",[v._v("**Geohash编码：**wm3vzf纬度二进制编码：101010110111010经度二进制编码：110010011111111公式：(Lat_bin - 1, Lon_bin)")]),v._v(" "),_("td",[v._v("**Geohash编码：**wm6jb4纬度二进制编码：101010110111010经度二进制编码：110010100000000公式：(Lat_bin - 1, Lon_bin + 1)")])])])]),v._v(" "),_("p",[v._v("附近3公里网格模型")]),v._v(" "),_("p",[_("img",{attrs:{src:t(623),alt:"img"}})]),v._v(" "),_("p",[_("img",{attrs:{src:t(624),alt:"image-20230315031553823"}})]),v._v(" "),_("h3",{attrs:{id:"geohash进阶原理-z阶曲线"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#geohash进阶原理-z阶曲线"}},[v._v("#")]),v._v(" geohash进阶原理（Z阶曲线)")]),v._v(" "),_("p",[v._v("上文讲了GeoHash的计算步骤，仅仅说明是什么而没有说明为什么？为什么分别给经度和维度编码？为什么需要将经纬度两串编码"),_("strong",[v._v("交叉组合")]),v._v("成一串编码？本节试图回答这一问题。")]),v._v(" "),_("p",[v._v("如下图所示，我们将二进制编码的结果填写到空间中，当将空间划分为四块时候，编码的顺序分别是左下角00，左上角01，右下脚10，右上角11，也就是类似于Z的曲线，当我们递归的将各个块分解成更小的子块时，编码的顺序是自相似的（分形），每一个子快也形成Z曲线，这种类型的曲线被称为 Peano 空间填充曲线。")]),v._v(" "),_("p",[v._v("这种类型的空间填充曲线的优点是将二维空间转换成一维曲线（事实上是分形维），对大部分而言，编码相似的距离也相近， 但Peano空间填充曲线最大的缺点就是"),_("strong",[v._v("突变性")]),v._v("，有些编码相邻但距离却相差很远，比如"),_("strong",[v._v("0111与1000")]),v._v("，编码是相邻的，但距离相差很大。")]),v._v(" "),_("p",[_("img",{attrs:{src:t(625),alt:"img"}})]),v._v(" "),_("p",[v._v("除 Peano 空间填充曲线外，还有很多空间填充曲线，如图所示，其中效果公认较好是 "),_("strong",[v._v("Hilbert")]),v._v(" 空间填充曲线，相较于 Peano 曲线而言，Hilbert 曲线"),_("strong",[v._v("没有较大的突变")]),v._v("。为什么 GeoHash 不选择 Hilbert 空间填充曲线呢？可能是 Peano曲线思路以及计算上比较简单吧，事实上，Peano 曲线就是一种"),_("strong",[v._v("四叉树线性编码方式。")])])])}),[],!1,null,null,null);_.default=a.exports},617:function(v,_,t){v.exports=t.p+"assets/img/57eb711c1d9cded841228b29b821eeba.d9478423.png"},618:function(v,_,t){v.exports=t.p+"assets/img/image-20230315022500048.ed8efde2.png"},619:function(v,_,t){v.exports=t.p+"assets/img/8eb57262b9cfb26dc94646465d72533c.9ac5a11b.png"},620:function(v,_,t){v.exports=t.p+"assets/img/b6c5b5530af147249e9a870f076f9978-1678818658611.5136befa.png"},621:function(v,_,t){v.exports=t.p+"assets/img/image-20230624011131681.cc1fd4a4.png"},622:function(v,_,t){v.exports=t.p+"assets/img/d34fee6fe2a510de033a1c103a952c4d.f6868af8.png"},623:function(v,_,t){v.exports=t.p+"assets/img/dc83cf2c5b09437938234726ca167a3e.6e1bacd4.png"},624:function(v,_,t){v.exports=t.p+"assets/img/image-20230315031553823.a41e7023.png"},625:function(v,_,t){v.exports=t.p+"assets/img/6f061d950a7b02080c4a5e7fd6dd51d4562cc8bd.a5920ab9.png"}}]);
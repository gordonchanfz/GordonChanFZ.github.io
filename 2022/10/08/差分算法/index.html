<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>差分算法 | 个人博客</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="./favicon.ico">
    <script>
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "https://hm.baidu.com/hm.js?55943ae09e5901d7a9f5705133737eec";
              var s = document.getElementsByTagName("script")[0];
              s.parentNode.insertBefore(hm, s);
            })();
           </script>
    <script src="https://hm.baidu.com/hm.js?xxxxxxxxxxx"></script>
    <meta name="description" content="会思考的芦苇。">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="robots" content="all">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="./assets/css/0.styles.f4f644f3.css" as="style"><link rel="preload" href="./assets/js/app.764dede6.js" as="script"><link rel="preload" href="./assets/js/13.20e964b9.js" as="script"><link rel="preload" href="./assets/js/1.8757f81f.js" as="script"><link rel="preload" href="./assets/js/12.b32071c5.js" as="script"><link rel="preload" href="./assets/js/34.ec572062.js" as="script"><link rel="prefetch" href="./assets/js/10.36ed4133.js"><link rel="prefetch" href="./assets/js/11.18e1c33d.js"><link rel="prefetch" href="./assets/js/14.d0932ff0.js"><link rel="prefetch" href="./assets/js/15.7747d51d.js"><link rel="prefetch" href="./assets/js/16.487f9c88.js"><link rel="prefetch" href="./assets/js/17.9ae2b89b.js"><link rel="prefetch" href="./assets/js/18.801c9b12.js"><link rel="prefetch" href="./assets/js/19.867ef46b.js"><link rel="prefetch" href="./assets/js/20.ec371d7f.js"><link rel="prefetch" href="./assets/js/21.73f810bc.js"><link rel="prefetch" href="./assets/js/22.8c016772.js"><link rel="prefetch" href="./assets/js/23.9aa3d5ef.js"><link rel="prefetch" href="./assets/js/24.a6dcda10.js"><link rel="prefetch" href="./assets/js/25.2fe13775.js"><link rel="prefetch" href="./assets/js/26.2296389e.js"><link rel="prefetch" href="./assets/js/27.21f2d66f.js"><link rel="prefetch" href="./assets/js/28.3209357f.js"><link rel="prefetch" href="./assets/js/29.c7065b7f.js"><link rel="prefetch" href="./assets/js/3.9efa3b27.js"><link rel="prefetch" href="./assets/js/30.92914cc9.js"><link rel="prefetch" href="./assets/js/31.13c12633.js"><link rel="prefetch" href="./assets/js/32.b016f60e.js"><link rel="prefetch" href="./assets/js/33.ed48a654.js"><link rel="prefetch" href="./assets/js/35.5b55607b.js"><link rel="prefetch" href="./assets/js/36.f50b6e38.js"><link rel="prefetch" href="./assets/js/37.34409ac4.js"><link rel="prefetch" href="./assets/js/38.c7073f77.js"><link rel="prefetch" href="./assets/js/39.12f063e9.js"><link rel="prefetch" href="./assets/js/4.95c562bd.js"><link rel="prefetch" href="./assets/js/40.1bbd5377.js"><link rel="prefetch" href="./assets/js/41.6331a8cf.js"><link rel="prefetch" href="./assets/js/42.28acd6f5.js"><link rel="prefetch" href="./assets/js/43.905d2114.js"><link rel="prefetch" href="./assets/js/44.041132c5.js"><link rel="prefetch" href="./assets/js/45.d1a66b92.js"><link rel="prefetch" href="./assets/js/46.1c9100fe.js"><link rel="prefetch" href="./assets/js/47.3e75f768.js"><link rel="prefetch" href="./assets/js/48.7d7248fb.js"><link rel="prefetch" href="./assets/js/49.8d465809.js"><link rel="prefetch" href="./assets/js/5.a1a0df33.js"><link rel="prefetch" href="./assets/js/50.4aa56564.js"><link rel="prefetch" href="./assets/js/51.59674bf5.js"><link rel="prefetch" href="./assets/js/52.f3990683.js"><link rel="prefetch" href="./assets/js/53.092fe0ad.js"><link rel="prefetch" href="./assets/js/54.ac62e2a7.js"><link rel="prefetch" href="./assets/js/55.3530fa5a.js"><link rel="prefetch" href="./assets/js/56.6e9bc6f3.js"><link rel="prefetch" href="./assets/js/6.e534639a.js"><link rel="prefetch" href="./assets/js/7.bc868936.js"><link rel="prefetch" href="./assets/js/8.ce0f4f25.js"><link rel="prefetch" href="./assets/js/9.a57a9cf0.js">
    <link rel="stylesheet" href="./assets/css/0.styles.f4f644f3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>Gordon</h3> <p class="description" data-v-59e6cb88>会思考的芦苇。</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>Gordon</span>
          
        <span data-v-59e6cb88>2018 - </span>
        2023
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/./" class="home-link router-link-active"><img src="./logo.png" alt="个人博客" class="logo"> <span class="site-name">个人博客</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/./" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      计算引擎
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./计算引擎/flink.html" class="nav-link"><i class="undefined"></i>
  flink
</a></li><li class="dropdown-item"><!----> <a href="/./计算引擎/spark.html" class="nav-link"><i class="undefined"></i>
  spark
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      存储引擎
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./存储引擎/ElasticSearch.html" class="nav-link"><i class="undefined"></i>
  ElasticSearch
</a></li><li class="dropdown-item"><!----> <a href="/./存储引擎/hbase.html" class="nav-link"><i class="undefined"></i>
  hbase
</a></li><li class="dropdown-item"><!----> <a href="/./存储引擎/redis.html" class="nav-link"><i class="undefined"></i>
  redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      云原生
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./云原生/Docker.html" class="nav-link"><i class="undefined"></i>
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      中间件
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./中间件/kafka.html" class="nav-link"><i class="undefined"></i>
  kafka
</a></li><li class="dropdown-item"><!----> <a href="/./中间件/Sqoop基本使用.html" class="nav-link"><i class="undefined"></i>
  Sqoop基本使用
</a></li></ul></div></div><div class="nav-item"><a href="/./tool/emoji/我的常用emoji.html" class="nav-link"><i class="undefined"></i>
  工具
</a></div><div class="nav-item"><a href="/./aboutme.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于我
</a></div> <a href="https://github.com/GordonChanFZ/gordonchanfz.github.io/" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><img src="./avatar.jpeg" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    Gordon
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>30</h3> <h6 data-v-1fad0c41>文章</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>47</h3> <h6 data-v-1fad0c41>标签</h6></div></div> <ul class="social-links" data-v-1fad0c41><li class="social-item" data-v-1fad0c41><i class="iconfont reco-github" style="color:#e15b64;" data-v-1fad0c41></i></li></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/./" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      计算引擎
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./计算引擎/flink.html" class="nav-link"><i class="undefined"></i>
  flink
</a></li><li class="dropdown-item"><!----> <a href="/./计算引擎/spark.html" class="nav-link"><i class="undefined"></i>
  spark
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      存储引擎
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./存储引擎/ElasticSearch.html" class="nav-link"><i class="undefined"></i>
  ElasticSearch
</a></li><li class="dropdown-item"><!----> <a href="/./存储引擎/hbase.html" class="nav-link"><i class="undefined"></i>
  hbase
</a></li><li class="dropdown-item"><!----> <a href="/./存储引擎/redis.html" class="nav-link"><i class="undefined"></i>
  redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      云原生
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./云原生/Docker.html" class="nav-link"><i class="undefined"></i>
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      中间件
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./中间件/kafka.html" class="nav-link"><i class="undefined"></i>
  kafka
</a></li><li class="dropdown-item"><!----> <a href="/./中间件/Sqoop基本使用.html" class="nav-link"><i class="undefined"></i>
  Sqoop基本使用
</a></li></ul></div></div><div class="nav-item"><a href="/./tool/emoji/我的常用emoji.html" class="nav-link"><i class="undefined"></i>
  工具
</a></div><div class="nav-item"><a href="/./aboutme.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于我
</a></div> <a href="https://github.com/GordonChanFZ/gordonchanfz.github.io/" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>差分算法</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>Gordon</span>
          
        <span data-v-59e6cb88>2018 - </span>
        2023
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">差分算法</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>Gordon</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2022-10-8</span></i> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>增量更新</span><span class="tag-item" data-v-8a445198>bisdiff/bispatch</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <h3 id="为何需要差异更新"><a href="#为何需要差异更新" class="header-anchor">#</a> <strong>为何需要差异更新？</strong></h3> <p><strong>差异更新即在软件更新时只更新差异化的部分，以达到用最小的下载量完成软件的更新需求</strong>。该思想由来已久，从刚接触电脑时的操作系统、应用软件快速更新功能或填补漏洞，到迭代更加频繁的移动应用时代更多了节省下载流量费用的需求。尤其在移动游戏领域，随着手机性能的提升和玩家对游戏体验的追求，安装包亦是越来越大，并且会频繁的更新以不断给玩家带来更新的玩法和更为优化的体验。然而，这种频繁的更新也同样会带来负面的影响：更新包太大没流量；更新速度太慢错过了本该用来玩游戏的碎片时间；本地空间不足无法更新等问题，这些负面影响都会导致一定程度上的玩家流失。因此，差异化更新能力目前已成为各应用下载渠道的必备能力之一，更小的更新包才能提高更新的成功率。</p> <h3 id="差异化更新方案有哪些"><a href="#差异化更新方案有哪些" class="header-anchor">#</a> 差异化更新方案有哪些？</h3> <p><strong>一种是基于源文件的差异化更新</strong>，该种方式成功率高， 算法简单，常用于平台相关的差异更新，但在移动端保存巨大的<strong>源文件</strong>、下载更新文件整合后再<strong>编译</strong>， 比如bsdiff、Xdelta3。</p> <p><strong>另一种可执行文件的二进制更新方式</strong>，比如Courgette</p> <p>Courgette来自于谷歌，主要解决的是可执行文件的差分，而更新资源不仅包含可执行文件，还包含了图片等各种资源文件，则需要基于所以，我们主要对比bsdiff和Xdelta3方案。</p> <p><strong>bsdiff和Xdelta3方案比较</strong></p> <p>下面是我们对选取的几个文件做的bsdiff和Xdelta3差分性能对比：</p> <p><img src="./assets/img/image-20230624005152428.98ae7330.png" alt="image-20230624005152428"></p> <p>bsdiff的优势是压缩比高，生成的差分文件非常小，但Patch过程耗时。而Xdelta3的优势是Patch过程耗时极短，但内存消耗非常大。</p> <h2 id="bsdiff算法"><a href="#bsdiff算法" class="header-anchor">#</a> bsdiff算法</h2> <p><strong>普通二进制文件对比</strong></p> <p>熟悉Linux的同学提到二进制文件对比自然会想到一个命令：cmp。那可执行文件的二进制更新岂不是有了这个对比结果后， 然后拿更新结果修改旧文件的二进制串为新文件不就OK了？用个最简单的方法测试下，旧文件testDiffUpdate_Old与更新后文件testDiffUpdate_New内容仅差了第一个字符0。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>xiaoyzhang$ <span class="token function">cat</span> testDiffUpdate_Old

<span class="token number">123456789</span>

xiaoyzhang$ <span class="token function">cat</span> testDiffUpdate_New

0123456789
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>通过CMP做两文件的对比后输出文件为testDiffUpdate_Delta，内容下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>xiaoyzhang$ <span class="token function">cmp</span> <span class="token parameter variable">-l</span> testDiffUpdate_New testDiffUpdate_Old <span class="token operator">&gt;</span> testDiffUpdate_Delta

cmp: EOF on testDiffUpdate_Old

xiaoyzhang$ <span class="token function">cat</span> testDiffUpdate_Delta

<span class="token number">1</span> <span class="token number">60</span> <span class="token number">61</span>

<span class="token number">2</span> <span class="token number">61</span> <span class="token number">62</span>

<span class="token number">3</span> <span class="token number">62</span> <span class="token number">63</span>

<span class="token number">4</span> <span class="token number">63</span> <span class="token number">64</span>

<span class="token number">5</span> <span class="token number">64</span> <span class="token number">65</span>

<span class="token number">6</span> <span class="token number">65</span> <span class="token number">66</span>

<span class="token number">7</span> <span class="token number">66</span> <span class="token number">67</span>

<span class="token number">8</span> <span class="token number">67</span> <span class="token number">70</span>

<span class="token number">9</span> <span class="token number">70</span> <span class="token number">71</span>

<span class="token number">10</span> <span class="token number">71</span> <span class="token number">12</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>如文件内容可知，通过简单的二进制对比得出的差异文件用来更新显然是不靠谱的，差异文件的内容远远比新旧两文件还要大的多。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>-rw-r--r-- <span class="token number">1</span> xiaoyzhang <span class="token number">1085706827</span> **110** <span class="token number">12</span> <span class="token number">23</span> <span class="token number">12</span>:33 testDiffUpdate_Delta

-rw-r--r-- <span class="token number">1</span> xiaoyzhang <span class="token number">1085706827</span> **11** <span class="token number">12</span> <span class="token number">23</span> <span class="token number">12</span>:29 testDiffUpdate_New

-rw-r--r-- <span class="token number">1</span> xiaoyzhang <span class="token number">1085706827</span> **10** <span class="token number">12</span> <span class="token number">23</span> <span class="token number">12</span>:28 testDiffUpdate_Old
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这个差异更新的问题看起来没有如此简单.</p> <p>BSDiff通过引入diff string的概念，大大减少了要记录的指针控制字的数目，从而使得patch包更小。</p> <h3 id="bsdiff初认识"><a href="#bsdiff初认识" class="header-anchor">#</a> bsdiff初认识</h3> <p>著名的计算机科学家--Colin Percival提出了BsDiff/BsPatch算法，用于差分及合成两个差异不超过50%的文件（如果差异差异超过50%，差分的效果较差）。</p> <p><img src="./assets/img/20160424124454898.9de02b6d.png" alt="img"></p> <h3 id="bsdiff基本步骤"><a href="#bsdiff基本步骤" class="header-anchor">#</a> <strong>BSDiff基本步骤</strong></h3> <p>bsdiff主要可以分为三部分：</p> <p>一、通过排序技术对old文件的内容进行排序，形成字典序。这里的排序使用的是后缀排序时间复杂度nlogn,空间复杂度O(n)，当然也可以使用hash技术进行排序。</p> <p>二、通过二分法查找最长的匹配len,有了这个len,就可以计算出diff string,和extra string.</p> <p>三、将diff string+extra string压缩到更新文件中。</p> <h4 id="步骤一-后缀排序生成子串的排名索引"><a href="#步骤一-后缀排序生成子串的排名索引" class="header-anchor">#</a> **步骤一.**后缀排序生成子串的排名索引</h4> <p>是所有差量更新算法的瓶颈，时间复杂度为O(nlogn),空间复杂度为O(n)，n为old文件的长度。BSDiff采用 Faster suffix sorting方法获得一个字典序，使用了类似于快速排序的二分思想，使用了bucket，I，V三个辅助数组。最终得到一个数组I，记录了以前缀分组的各个字符串组的最后一个字符串在old中的开始位置</p> <p><strong>后缀排序</strong></p> <p>构造后缀数组目的是为了找最长公共子序列</p> <p>后缀排序之朴素（n * n * logn）：</p> <p>通过朴素思路理解后缀数组含义</p> <p>字符串“ABCA“</p> <p>1.遍历取出所有后缀suffix[i]</p> <img src="差分算法.assets/image-20230317145134814.png" alt="image-20230317145134814" style="zoom:50%;"> <p>2.后缀排序，得到sa[i] (排序后的后缀在原后缀的顺序),rank[i] (后缀经过排序后的位置)，与sa互逆。</p> <p><img src="./assets/img/image-20230317152430091.690a0340.png" alt="image-20230317152430091"></p> <p>生成后缀串，是枚举每个开始位置，然后往后截取，这个动作就是O(N^2)<br>
那么对这N个后缀串排序，就是O(N * logN)，而字符串比较本身又不是O(1)，所以其实排序还不止O(N * logN)，应该是O(N * logN * N)<br>
这个时间复杂度是很高的</p> <p>diff中的qusort,倍增（n * logn），SA-IS是线性的（n）,具体见扩展。</p> <h4 id="步骤二、找公共子串-划分diff-string和extra-string"><a href="#步骤二、找公共子串-划分diff-string和extra-string" class="header-anchor">#</a> 步骤二、找公共子串，划分diff string和extra string</h4> <p>公共子序列，允许有50%不同。</p> <p>是BSDiff产生patch包的核心部分，详细描述如下：</p> <p>这里以old：ababa，new：abacd14327为例进行举例说明。</p> <p>1.新旧文件，经过search后生成的len为5，对比发现这5个字符串并不完全相同（这里相差2，实际需要相差8才进入生成步骤）；</p> <p>2.ababa以及abacd，生成diff string，如：00011（其中0表示相同，1表示不同）；</p> <p>3.这时old已经没有字符了，new文件中的14327为extra；</p> <p>4.按顺序将各个block压缩后，写入文件（注：bsdiff()方法中本身没有对stream进行压缩，只是在main中加入了bzip2压缩）</p> <p>I代表已经排好的字典序，scan代表new中要查询的字符，pos代表old中相匹配的字符，len代表匹配的长度，lastscan=scan-lenb,lastpos=pos-lenb。lastoffset=scan-pos。lastoffset为new和old的偏移量,如果在old中的内容A在new中可以找到，而且A+lastoffset=new中的A，则认为old和new中的A相同。oldscore代表相同内容的len,scsc代表new中开始和old中比较是否相同开始的位置，而old中开始的位置是scsc+lastoffset。lenf代表扩展前缀，lenb代表扩展后缀。</p> <p><img src="./assets/img/20160424124812650.40497586.png" alt="img"></p> <p><img src="./assets/img/20160424124859572.1d157365.png" alt="img"></p> <p><img src="./assets/img/20160424125102547.a827eb75.png" alt="img"></p> <p><strong>一般动态规划算法——最长公共子串</strong></p> <p>1.基本概念</p> <div class="language- extra-class"><pre><code>  首先需要科普一下，最长公共子序列（longest common sequence）和最长公共子串（longest common substring）不是一回事儿。什么是子序列呢？即一个给定的序列的子序列，就是将给定序列中零个或多个元素去掉之后得到的结果。什么是子串呢？给定串中任意个连续的字符组成的子序列称为该串的子串。给一个图再解释一下：
</code></pre></div><p><img src="./assets/img/20160529225550069.ac39f490.jpg" alt="img"></p> <div class="language- extra-class"><pre><code>   如上图，给定的字符序列： {a,b,c,d,e,f,g,h}，它的子序列示例： {a,c,e,f} 即元素b,d,g,h被去掉后，保持原有的元素序列所得到的结果就是子序列。同理，{a,h},{c,d,e}等都是它的子序列。
   它的字串示例：{c,d,e,f} 即连续元素c,d,e,f组成的串是给定序列的字串。同理，{a,b,c,d},{g,h}等都是它的字串。
 这个问题说明白后，最长公共子序列（以下都简称LCS）就很好理解了。
</code></pre></div><p>根据以上条件可知状态转移方程为：</p> <p><img src="./assets/img/e3ad24c15d6ebaf89b717481ff45fe0a.e75c06ad.png" alt="img"></p> <p><img src="./assets/img/a164d68c4c86b605427697a35945f3c4.cc7a0bcc.png" alt="img"></p> <p>最长公共子串{a,d}</p> <p>构建c[i][j]表需要O(mn)</p> <p><strong>suffix_search采用二分查找</strong>（O(nlogn)）</p> <h4 id="步骤三、-合并压缩成patch包"><a href="#步骤三、-合并压缩成patch包" class="header-anchor">#</a> **步骤三、**合并压缩成patch包</h4> <p>将diff string 和extrastring 以及相应的控制字用zip压缩成一个patch包。</p> <p><img src="./assets/img/20160424125148292.b4afbea6.png" alt="img"></p> <p>可以看出在用zip压缩之前的patch包是没有节约任何字符的，但diff strings可以被高效的压缩，故BSDiff是一个很依赖于压缩与解压的算法！</p> <h3 id="bspatch基本步骤"><a href="#bspatch基本步骤" class="header-anchor">#</a> <strong>BSPatch基本步骤</strong></h3> <p>客户端合成patch的基本步骤如下：</p> <p>1．接收patch包；</p> <p>2．解压patch包；</p> <p>3．还原new文件。</p> <p>三个步骤同时在O（m）时间内完成，但在时间常数上更依赖于解压patch包的部分，m为新文件的长度</p> <p><strong>复杂度分析</strong></p> <p>根据以上步骤，不难得出BSDiff与BSPatch的时间与空间复杂度如下：</p> <p>BSDiff</p> <p>时间复杂度 O(nlogn) 空间复杂度 O(n)</p> <p>BSPatch</p> <p>时间复杂度 O(n+m)  空间复杂度 O(n+m)</p> <h3 id="进一步优化方案"><a href="#进一步优化方案" class="header-anchor">#</a> 进一步优化方案：</h3> <p><strong>原生bsdiff方案缺陷与改进</strong></p> <p>1.排序算法替换成divsufsort算法</p> <p>原生bsdiff方案使得压缩比问题得到解决，但在车载导航自更新中还存在下面两个缺陷：</p> <ul><li>内存消耗大，整个过程会占用10~35MB左右的内存。</li> <li>耗时长，整个包更新时间在3分钟左右。</li></ul> <p>在对bsdiff的优化探索中我们发现Chromium开源项目中存在一份基于bsdiff的优化版本。该版本将bsidff的默认sufsort算法替换成了divsufsort算法，在Patch时间上有了较大的提升。</p> <p><img src="./assets/img/image-20230624005240472.1d71dd3e.png" alt="image-20230624005240472"></p> <p><img src="./assets/img/image-20230624005253138.81fdf9b3.png" alt="image-20230624005253138"></p> <p>2.压缩方式上面做文章</p> <p>Patch过程的主要性能瓶颈在于Bzip2的解压算法中，即使调整Bzip2参数也无法减少本身的计算量。</p> <p>bsdiff差分算法的一个特性就是差分出的Patch数据包含了大量连续的01冗余数据，而Bzip2算法的优点就是对这类数据可以做到高度的压缩，这也是bsdiff压缩比高的原因。不过现在是目前的瓶颈。</p> <p>此外，我们会制作软件整体的压缩差分包(即生成tar.bz2或zip格式文件)，也就是说针对每个Bzip2压缩后的差分文件还要再经过一次压缩归档。这也意味着在客户段要进行两次的解压。</p> <p><strong>替换压缩算法</strong></p> <p>类似的冗余压缩算法有RLE(Run-length encoding)，这个算法也是Bzip2算法的第一步。简单来说RLE算法就是针对连续多个冗余字节去掉其冗余字节，仅保留冗余的长度信息。这个算法相对更简单。</p> <p>因此，我们将Bzip2压缩算法替换成了RLE算法，实际结果发现生成的Patch文件很大, 压缩比很低。但是可以通过再次压缩归档制作一次差分包，就可以达到和Bzip2几乎相同的压缩比效果。唯一的不足就是在客户端解压后会占用多一些磁盘空间, 而这个代价相对廉价多了。</p> <h3 id="使用方法"><a href="#使用方法" class="header-anchor">#</a> 使用方法</h3> <p>1.直接调用java的实现jbsdiff方式</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.sigpipe<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jbsdiff<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>①命令行的方式：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#将项目打成jar包 执行如下命令：</span>
<span class="token function">java</span> <span class="token parameter variable">-jar</span> jbsdiff.jar diff/patch  oldfile newfile patchfile
<span class="token comment">#支持指定的压缩算法（但算法仅仅是来自Apache Commons Compress 库），bzip2（默认值）、gz、pack200 和 xz。</span>
<span class="token function">java</span> <span class="token parameter variable">-Djbsdiff.compressor</span><span class="token operator">=</span>gz <span class="token parameter variable">-jar</span> jbsdiff.jar <span class="token function">diff</span> a.bin b.bin patch.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>②当成一个library使用：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//调用FileUI类</span>
<span class="token comment">//生成差分包：</span>
<span class="token class-name">FileUI</span><span class="token punctuation">.</span><span class="token function">diff</span><span class="token punctuation">(</span>oldFile<span class="token punctuation">,</span> newFile<span class="token punctuation">,</span> patchFile<span class="token punctuation">,</span> compression<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//diff(oldFile, newFile, patchFile, CompressorStreamFactory.BZIP2);//压缩默认bzip2</span>
<span class="token comment">//还原：</span>
<span class="token class-name">FileUI</span><span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span>oldFile<span class="token punctuation">,</span> newFile<span class="token punctuation">,</span> patchFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>命令行的图解使用过程</p> <p><img src="./assets/img/image-20230315221953771.0bc4bd66.png" alt="image-20230315221953771"></p> <p><img src="./assets/img/image-20230315222357577.3b31b342.png" alt="image-20230315222357577"></p> <p><img src="./assets/img/image-20230315222734907.8e3ed384.png" alt="image-20230315222734907"></p> <p>导入library调用图解</p> <p><img src="./assets/img/image-20230315225319857.ca6c69ee.png" alt="image-20230315225319857"></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>sigpipe<span class="token punctuation">.</span>jbsdiff<span class="token punctuation">.</span></span><span class="token class-name">InvalidHeaderException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>sigpipe<span class="token punctuation">.</span>jbsdiff<span class="token punctuation">.</span>ui<span class="token punctuation">.</span></span><span class="token class-name">FileUI</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>compress<span class="token punctuation">.</span>compressors<span class="token punctuation">.</span></span><span class="token class-name">CompressorException</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BsDiffTest</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">InvalidHeaderException</span><span class="token punctuation">,</span> <span class="token class-name">CompressorException</span> <span class="token punctuation">{</span>
        <span class="token class-name">File</span> oldFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;E:\\BigData\\learning\\bsdiff\\1.zip&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> newFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;E:\\BigData\\learning\\bsdiff\\2.zip&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> patchFile_bzip2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;E:\\BigData\\learning\\bsdiff\\delta_bzip2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> patchFile_gz <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;E:\\BigData\\learning\\bsdiff\\delta_gz&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> outFile<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;E:\\BigData\\learning\\bsdiff\\out.zip&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> compression_bzip2<span class="token operator">=</span><span class="token string">&quot;bzip2&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> compression_gz<span class="token operator">=</span><span class="token string">&quot;gz&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">FileUI</span><span class="token punctuation">.</span><span class="token function">diff</span><span class="token punctuation">(</span>oldFile<span class="token punctuation">,</span> newFile<span class="token punctuation">,</span> patchFile_bzip2<span class="token punctuation">,</span> compression_bzip2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FileUI</span><span class="token punctuation">.</span><span class="token function">diff</span><span class="token punctuation">(</span>oldFile<span class="token punctuation">,</span> newFile<span class="token punctuation">,</span> patchFile_gz<span class="token punctuation">,</span> compression_gz<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FileUI</span><span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span>oldFile<span class="token punctuation">,</span> outFile<span class="token punctuation">,</span> patchFile_gz<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>2.JNI调用C语言的实现方式（不建议花时间自己实现）</p> <p>运行的环境可能是在window，mac或者linux等。所以，我们需要把bsdiff的源码编译成对应环境需要的 native 库文件，以便于给Java调用。<br>
由于大多数项目基本都是在linux上运行的，这里就演示下如何把bsdiff源码编译成linux环境的so文件，然后在java代码中调用。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bsdiff 官网介绍的时候提到bsdiff用到了 bzip2 。

所以我们需要下载bsdiff和bzip2 源码。

bsdiff: http://www.daemonology.net/bsdiff/bsdiff-4.3.tar.gz(被禁用了，用最底下广大网友提供的资源）
bzip2: https://www.sourceware.org/bzip2/downloads.html


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="扩展-差分数组"><a href="#扩展-差分数组" class="header-anchor">#</a> 扩展：差分数组</h3> <p><strong>前缀和</strong>主要适用的场景是<strong>原始数组不会被修改</strong>的情况下，频繁<strong>查询</strong>某个区间的累加和。</p> <p>这里简单介绍一下前缀和，核心代码就是下面这段：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">PrefixSum</span> <span class="token punctuation">{</span>
  <span class="token comment">// 前缀和数组</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> prefix<span class="token punctuation">;</span>
  <span class="token comment">// 输入一个数组，构造前缀和 </span>
  <span class="token keyword">public</span> <span class="token class-name">PrefixSum</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    prefix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// 计算 nums 的累加和</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> prefix<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      prefix<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> prefix<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 查询闭区间 [i, j] 的累加和 </span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> prefix<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> prefix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><img src="./assets/img/640.a3e66a9a.jpg" alt="Image"></p> <p><code>prefix[i]</code>就代表着<code>nums[0..i-1]</code>所有元素的累加和，如果我们想求区间<code>nums[i..j]</code>的累加和，只要计算<code>prefix[j+1] - prefix[i]</code>即可，而不需要遍历整个区间求和。</p> <p>本文讲一个和前缀和思想非常类似的算法技巧「差分数组」，<strong>差分数组</strong>的主要适用场景是<strong>频繁对原始数组</strong>的<strong>某个区间的元素进行增减</strong>。</p> <p>比如说，我给你输入一个数组<code>nums</code>，然后又要求给区间<code>nums[2..6]</code>全部加 1，再给<code>nums[3..9]</code>全部减 3，再给<code>nums[0..4]</code>全部加 2，再给…</p> <p>一通操作猛如虎，然后问你，最后<code>nums</code>数组的值是什么？</p> <p>常规的思路很容易，你让我给区间<code>nums[i..j]</code>加上<code>val</code>，那我就一个 <strong>for 循环</strong>给它们都加上呗，还能咋样？这种思路的<strong>时间复杂度是 O(N)</strong>，由于这个场景下对<code>nums</code>的修改非常频繁，所以效率会很低下。</p> <p>这里就需要差分数组的技巧，类似前缀和技巧构造的<code>prefix</code>数组，我们先对<code>nums</code>数组构造一个<code>diff</code>差分数组，<strong><code>diff[i]</code>就是<code>nums[i]</code>和<code>nums[i-1]</code>之差</strong>：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> diff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 构造差分数组</span>
diff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    diff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> nums<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><img src="./assets/img/640-1678872582901.fd4701b3.jpg" alt="Image"></p> <p>通过这个<code>diff</code>差分数组是可以反推出原始数组<code>nums</code>的，代码逻辑如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>diff<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 根据差分数组构造结果数组</span>
res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> diff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> diff<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> diff<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>这样构造差分数组<code>diff</code>，就可以快速进行区间增减的操作</strong>，如果你想对区间<code>nums[i..j]</code>的元素全部加 3，那么只需要让<code>diff[i] += 3</code>，然后再让<code>diff[j+1] -= 3</code>即可：</p> <p><img src="./assets/img/640-1678872856874.e59d5883.jpg" alt="Image"></p> <p><strong>原理很简单，回想<code>diff</code>数组反推<code>nums</code>数组的过程，<code>diff[i] += 3</code>意味着给<code>nums[i..]</code>所有的元素都加了 3，然后<code>diff[j+1] -= 3</code>又意味着对于<code>nums[j+1..]</code>所有元素再减 3，那综合起来，是不是就是对<code>nums[i..j]</code>中的所有元素都加 3 了</strong>？</p> <p>只要花费 <strong>O(1) 的时间</strong>修改<code>diff</code>数组，就相当于给<code>nums</code>的整个区间做了修改。多次修改<code>diff</code>，然后通过<code>diff</code>数组反推，即可得到<code>nums</code>修改后的结果。</p> <p>现在我们把差分数组抽象成一个类，包含<code>increment</code>方法和<code>result</code>方法：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 差分数组工具类</span>
<span class="token keyword">class</span> <span class="token class-name">Difference</span> <span class="token punctuation">{</span>
    <span class="token comment">// 差分数组</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> diff<span class="token punctuation">;</span>

    <span class="token comment">/* 输入一个初始数组，区间操作将在这个数组上进行 */</span>
    <span class="token keyword">public</span> <span class="token class-name">Difference</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">assert</span> nums<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
        diff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// 根据初始数组构造差分数组</span>
        diff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            diff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> nums<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/* 给闭区间 [i,j] 增加 val（可以是负数）*/</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">,</span> <span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        diff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> val<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> diff<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            diff<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-=</span> val<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/* 返回结果数组 */</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>diff<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// 根据差分数组构造结果数组</span>
        res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> diff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> diff<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> diff<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> res<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>这里注意一下<code>increment</code>方法中的 if 语句：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">,</span> <span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    diff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> val<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> diff<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        diff<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-=</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>当<code>j+1 &gt;= diff.length</code>时，说明是对<code>nums[i]</code>及以后的整个数组都进行修改，那么就不需要再给<code>diff</code>数组减<code>val</code>了。</p> <p><strong>应用1：航班预订</strong></p> <p><img src="./assets/img/640.c5609826.png" alt="Image"></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">corpFlightBookings</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bookings<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// nums 初始化为全 0</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// 构造差分解法</span>
    <span class="token class-name">Difference</span> df <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Difference</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> booking <span class="token operator">:</span> bookings<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 注意转成数组索引要减一哦</span>
        <span class="token keyword">int</span> i <span class="token operator">=</span> booking<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> j <span class="token operator">=</span> booking<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> val <span class="token operator">=</span> booking<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// 对区间 nums[i..j] 增加 val</span>
        df<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 返回最终的结果数组</span>
    <span class="token keyword">return</span> df<span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>动态规划--最长公共子序列（不连续）</p> <p>给定序列s1={1,3,4,5,6,7,7,8},s2={3,5,7,4,8,6,7,8,2}，s1和s2的相同子序列，且该子序列的长度最长，即是LCS。<br>
s1和s2的其中一个最长公共子序列是 {3,4,6,7,8}</p> <p>求解步骤①递归构建二阶矩阵，计算LCS长度</p> <p>递归公式<img src="./assets/img/20160529233036349.019ccd42.jpg" alt="img"></p> <p><img src="./assets/img/20160529234635745.7b53ef10.jpg" alt="img"></p> <p><img src="./assets/img/20160529234714513.085d30d6.jpg" alt="img"></p> <p>求解步骤②，找出最长子序列的其中一种组成。动态规划的可能有多个可行解，返回一种可能的子序列</p> <p><img src="./assets/img/20160529234721620.017ffb7a.jpg" alt="img"></p> <p>这就是倒推回去的路径，棕色方格为相等元素，即LCS = {3,4,6,7,8}，这是其中一个结果。</p> <p><img src="./assets/img/20160529234726935.ea3628c2.jpg" alt="img"></p> <p>另一种结果，即LCS ={3,5,7,7,8}。</p> <p><strong>时间复杂度</strong></p> <p>​    构建c[i][j]表需要O(mn)，输出1个LCS的序列需要O(m+n)。</p> <p><strong>后缀数组之倍增法（n * logn*logn）：</strong></p> <p>首先用计数排序的方法对单个字符进行排序，得到按单字符进行排序后的rank[]，以后的排序就是以此数组代表字符进行排序。</p> <p>ａａｂａａａａｂａ</p> <p>１１２１１１１２１（rank[]）</p> <p>单个字符很有可能是有重复的，所以要比较第二个字符。但是第二个字符的大小已经比较过了(最后一个字符开始的串没有第二个字符，所以补0)。即</p> <p>ａｂａａａａｂａ0</p> <p>１２１１１１２１0</p> <p>这样就以第二个字符的大小为第二关键字，第一个字符的大小为第一关键字进行基数排序。得到以两个字符进行排序后的rank[]。</p> <p>同样，我们可以用后面已经算好的两个字符的大小算出按4个字符排序的顺序。然后是8个、16个……。直到字符串的长度。</p> <p>1 将字符串 s(aabaaaab)从每个下标开始长度为 1 的子串进行排名，直接将每个字符转换成 s[i]-'a'+1即可，如下图所示。</p> <p><img src="./assets/img/4cbb71456e5447f6bce61ab3692e08dc.131a1514.png" alt="img"></p> <p>2 求解长度为 2 的子串排名。</p> <p>将上一次 rank 值的第 i 个和 第 i+1 个结合，相对于得到长度为 2 的子串的每个位置排名，然后排序，即可得到长度为 2 的子串排名。</p> <p><img src="./assets/img/980bc522ba44485e931d960569994f6f.58547dbc.png" alt="img"></p> <p>3 求解长度为 2^2 的子串排名。</p> <p>将上一次 rank 值的第 i 个和第 i+2 个结合，相对于得到长度为 2^2 的子串的每个位置排名，排序后得到长度为 2^2 的子串排名。</p> <p><img src="./assets/img/0f9ee36dd409456fbd041aa709601acc-1679045089310.af01813e.png" alt="img"></p> <p>4 求解长度为 2^3 的子串排名。</p> <p>将上一次 rank 值的第 i 个和第 i+4 个结合，相对于得到长度为 2^3 的子串的每个位置排名，排序后得到长度为 2^3 的子串排名。</p> <p><img src="./assets/img/ec526a8ed23b43759c59e1edbe4ace04.0a5ed4c0.png" alt="img"></p> <p>第 4 步和第 3 步的结果一样，<strong>实际上，若在 rank 没有相同值时，就已经得到了后缀排名，就不需要再继续运算了</strong>。因为根据字符串比较规则，两个字符串的前几个字符已经分出大小，后面无须判断。</p> <p>将排名数组转换为后缀数组，排名第1的下标为3，排名第2的下标为4，排名第3的下标为5，排名第4的下标为0，排名第5的下标为6，排名为6的下标为1，排名第7的下标为7，排名第8的下标为2，因此SA[]={3,4,5,0,6,1,7,2}。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">SuffixArray</span> <span class="token punctuation">{</span>

  <span class="token comment">// Length of the suffix array</span>
  <span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token class-name">N</span><span class="token punctuation">;</span>

  <span class="token comment">// T is the text</span>
  <span class="token keyword">protected</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">T</span><span class="token punctuation">;</span>

  <span class="token comment">// The sorted suffix array values.</span>
  <span class="token keyword">protected</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sa<span class="token punctuation">;</span>

  <span class="token comment">// Longest Common Prefix array</span>
  <span class="token keyword">protected</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> lcp<span class="token punctuation">;</span>

  <span class="token keyword">private</span> <span class="token keyword">boolean</span> constructedSa <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">boolean</span> constructedLcpArray <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">SuffixArray</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>text <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;Text cannot be null.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>T</span> <span class="token operator">=</span> text<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>N</span> <span class="token operator">=</span> text<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getTextLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">T</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Returns the suffix array.</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getSa</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">buildSuffixArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> sa<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Returns the LCP array.</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getLcpArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">buildLcpArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> lcp<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Builds the suffix array by calling the construct() method.</span>
  <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">buildSuffixArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>constructedSa<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token function">construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    constructedSa <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Builds the LCP array by first creating the SA and then running the kasai algorithm.</span>
  <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">buildLcpArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>constructedLcpArray<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token function">buildSuffixArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">kasai</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    constructedLcpArray <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">toIntArray</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> t<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// The suffix array construction algorithm is left undefined</span>
  <span class="token comment">// as there are multiple ways to do this.</span>
  <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Use Kasai algorithm to build LCP array</span>
  <span class="token comment">// http://www.mi.fu-berlin.de/wiki/pub/ABI/RnaSeqP4/suffix-array.pdf</span>
  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">kasai</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    lcp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token class-name">N</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> inv <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token class-name">N</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">N</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> inv<span class="token punctuation">[</span>sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">N</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>inv<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> k <span class="token operator">=</span> sa<span class="token punctuation">[</span>inv<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> len <span class="token operator">&lt;</span> <span class="token class-name">N</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> len <span class="token operator">&lt;</span> <span class="token class-name">N</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">T</span><span class="token punctuation">[</span>i <span class="token operator">+</span> len<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token class-name">T</span><span class="token punctuation">[</span>k <span class="token operator">+</span> len<span class="token punctuation">]</span><span class="token punctuation">)</span> len<span class="token operator">++</span><span class="token punctuation">;</span>
        lcp<span class="token punctuation">[</span>inv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> len<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> len<span class="token operator">--</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SuffixArrayMed</span> <span class="token keyword">extends</span> <span class="token class-name">SuffixArray</span> <span class="token punctuation">{</span>

  <span class="token comment">// Wrapper class to help sort suffix ranks</span>
  <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">SuffixRankTuple</span> <span class="token keyword">implements</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SuffixRankTuple</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">int</span> firstHalf<span class="token punctuation">,</span> secondHalf<span class="token punctuation">,</span> originalIndex<span class="token punctuation">;</span>

    <span class="token comment">// Sort Suffix ranks first on the first half then the second half</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">SuffixRankTuple</span> other<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> cmp <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>firstHalf<span class="token punctuation">,</span> other<span class="token punctuation">.</span>firstHalf<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>cmp <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>secondHalf<span class="token punctuation">,</span> other<span class="token punctuation">.</span>secondHalf<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> cmp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originalIndex <span class="token operator">+</span> <span class="token string">&quot; -&gt; (&quot;</span> <span class="token operator">+</span> firstHalf <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> secondHalf <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">SuffixArrayMed</span><span class="token punctuation">(</span><span class="token class-name">String</span> text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token function">toIntArray</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">SuffixArrayMed</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Construct a suffix array in O(nlog^2(n))</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sa <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token class-name">N</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// Maintain suffix ranks in both a matrix with two rows containing the</span>
    <span class="token comment">// current and last rank information as well as some sortable rank objects</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> suffixRanks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token class-name">N</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">SuffixRankTuple</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ranks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuffixRankTuple</span><span class="token punctuation">[</span><span class="token class-name">N</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// Assign a numerical value to each character in the text</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">N</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      suffixRanks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">T</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      ranks<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuffixRankTuple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// O(log(n))</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> pos <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> pos <span class="token operator">&lt;</span> <span class="token class-name">N</span><span class="token punctuation">;</span> pos <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">N</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SuffixRankTuple</span> suffixRank <span class="token operator">=</span> ranks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        suffixRank<span class="token punctuation">.</span>firstHalf <span class="token operator">=</span> suffixRanks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        suffixRank<span class="token punctuation">.</span>secondHalf <span class="token operator">=</span> i <span class="token operator">+</span> pos <span class="token operator">&lt;</span> <span class="token class-name">N</span> <span class="token operator">?</span> suffixRanks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i <span class="token operator">+</span> pos<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        suffixRank<span class="token punctuation">.</span>originalIndex <span class="token operator">=</span> i<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// O(nlog(n))</span>
      <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Arrays</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>ranks<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">int</span> newRank <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      suffixRanks<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>ranks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>originalIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">N</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">SuffixRankTuple</span> lastSuffixRank <span class="token operator">=</span> ranks<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">SuffixRankTuple</span> currSuffixRank <span class="token operator">=</span> ranks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// If the first half differs from the second half</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currSuffixRank<span class="token punctuation">.</span>firstHalf <span class="token operator">!=</span> lastSuffixRank<span class="token punctuation">.</span>firstHalf
            <span class="token operator">||</span> currSuffixRank<span class="token punctuation">.</span>secondHalf <span class="token operator">!=</span> lastSuffixRank<span class="token punctuation">.</span>secondHalf<span class="token punctuation">)</span> newRank<span class="token operator">++</span><span class="token punctuation">;</span>

        suffixRanks<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>currSuffixRank<span class="token punctuation">.</span>originalIndex<span class="token punctuation">]</span> <span class="token operator">=</span> newRank<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// Place top row (current row) to be the last row</span>
      suffixRanks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> suffixRanks<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

      <span class="token comment">// Optimization to stop early</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>newRank <span class="token operator">==</span> <span class="token class-name">N</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Fill suffix array</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">N</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> ranks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>originalIndex<span class="token punctuation">;</span>
      ranks<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Cleanup</span>
    suffixRanks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> suffixRanks<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    suffixRanks <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    ranks <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// String[] strs = { &quot;AAGAAGC&quot;, &quot;AGAAGT&quot;, &quot;CGAAGC&quot; };</span>
    <span class="token comment">// String[] strs = { &quot;abca&quot;, &quot;bcad&quot;, &quot;daca&quot; };</span>
    <span class="token comment">// String[] strs = { &quot;abca&quot;, &quot;bcad&quot;, &quot;daca&quot; };</span>
    <span class="token comment">// String[] strs = { &quot;AABC&quot;, &quot;BCDC&quot;, &quot;BCDE&quot;, &quot;CDED&quot; };</span>
    <span class="token comment">// String[] strs = { &quot;abcdefg&quot;, &quot;bcdefgh&quot;, &quot;cdefghi&quot; };</span>
    <span class="token comment">// String[] strs = { &quot;xxx&quot;, &quot;yyy&quot;, &quot;zzz&quot; };</span>
    <span class="token comment">// TreeSet &lt;String&gt; lcss = SuffixArrayMed.lcs(strs, 2);</span>
    <span class="token comment">// System.out.println(lcss);</span>

    <span class="token comment">// SuffixArrayMed sa = new SuffixArrayMed(&quot;abracadabra&quot;);</span>
    <span class="token comment">// System.out.println(sa);</span>
    <span class="token comment">// System.out.println(java.util.Arrays.toString(sa.sa));</span>
    <span class="token comment">// System.out.println(java.util.Arrays.toString(sa.lcp));</span>

    <span class="token class-name">SuffixArrayMed</span> sa <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuffixArrayMed</span><span class="token punctuation">(</span><span class="token string">&quot;ABBABAABAA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// SuffixArrayMed sa = new SuffixArrayMed(&quot;GAGAGAGAGAGAG&quot;);</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br></div></div><p>后缀排序之DC3（n）--基数排序，据多方测试dc3</p> <p>后缀数组构造之SA-IS（n）</p> <p>步骤：</p> <p>①增加特殊尾字符(取一个比数字和字母小的字符比如*，$，！)；</p> <p>②确定后缀类型（尾字符规定为S类型，其他的倒序遍历i&lt;（i+1）则为S,大于则为L，相同与（i+1）类型一样 )；</p> <p><img src="data:image/png;base64,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" alt="image-20230318213503677"></p> <p>③找出LMS子串基数排序，如果子串相同，需要递归①到③，直到LMS子串能排序；</p> <p>④遍历桶数组，添加元素前一个字符的L型后缀（尾插：遍历桶数组时从小到大的，所以尾插能保证顺序），非L型的不添加；</p> <p><img src="data:image/png;base64,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" alt="image-20230318213542099"></p> <p>⑤去除LMS子串；</p> <p><img src="data:image/png;base64,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" alt="image-20230318213620147"></p> <p>⑥倒序头插S型后缀（倒序遍历从大到小，头插保证小的在前）；</p> <p><img src="data:image/png;base64,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" alt="image-20230318213639603"></p> <p>⑦取得后缀数组。</p> <p>LSM子串需要进一步判断的情况：</p> <p><img src="./assets/img/image-20230318222334616.e689b554.png" alt="image-20230318222334616"></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">SAIS</span> <span class="token punctuation">{</span>
	<span class="token keyword">static</span> <span class="token keyword">char</span> saisyo <span class="token operator">=</span> <span class="token char">'!'</span><span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">SAISENGINE</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-</span> saisyo <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> result <span class="token operator">=</span> <span class="token function">SAIS</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> result<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">SAIS</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> spe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">int</span> len <span class="token operator">=</span> s<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//字符数，包括尾随字符</span>
			<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>len<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//收到的字符串数组不包含尾随字符，因此需要创建一个新数组并分配它。</span>
			<span class="token punctuation">}</span>
			str<span class="token punctuation">[</span>str<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token constant">LS</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>len<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//包含 L 型 S 型 L=1 S=0 的数组</span>
			<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token constant">LMS</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>len<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//包含 LMS 是否的数组 LMS 的正整数 -1 如果不是</span>
			<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">LMSsublen</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>len<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//包含 LMS 子字符串长度的数组</span>
			<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">LMSlist</span><span class="token punctuation">;</span><span class="token comment">// 仅包含 LMS 索引的数组（从原始字符串的长度中不知道 LMS 的数量，因此可变长度数组更容易）</span>
			<span class="token keyword">int</span> <span class="token class-name">LMScount</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//LMS 的数量（如果您在可变长度数组中只有一个 LMS 的列表，则不必为索引管理而烦恼）</span>
			<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> used <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>len<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//是否放入后缀数组的数组</span>
			<span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>used<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//初始化 如果您正在使用 1 并且您没有使用它，则输入 0</span>
			<span class="token constant">SA</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sa <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SA</span><span class="token punctuation">[</span>spe<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//保存 SA 放入后缀数组的索引</span>
			<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>spe<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 包含出现哪些字符和出现次数的数组</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				dict<span class="token punctuation">[</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> spe<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SA</span><span class="token punctuation">(</span>dict<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 初始化后缀数组</span>
			<span class="token punctuation">}</span>
			<span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token constant">LMS</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token class-name">LMSsublen</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token constant">LS</span><span class="token punctuation">[</span>len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//L型或S型计算</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> len <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//从后面看</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> str<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token constant">LS</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">LS</span><span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//如果两个相邻字符相同，则后面的字符取决于</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> str<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token constant">LS</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// L</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> str<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token constant">LS</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// S</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//探索您的学习管理系统</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">LS</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">LS</span><span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token constant">LMS</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// LMS</span>
					<span class="token class-name">LMScount</span><span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">//计算 LMS 的数量</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token constant">LMS</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//当不是 LMS-1 时</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token constant">LMS</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//第一个字符不会成为 LMS</span>
			<span class="token class-name">LMSlist</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token class-name">LMScount</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 仅 LMS 阵列</span>
			<span class="token keyword">int</span> tmpindex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">LMS</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token class-name">LMSlist</span><span class="token punctuation">[</span>tmpindex<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span> <span class="token comment">//创建仅包含 LMS 索引的数组</span>
					tmpindex<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//验证到 Coco 5/13 标志 1 号</span>
			sa <span class="token operator">=</span> <span class="token function">resetindex</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">LMSlist</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//计算 LMS 子字符串的长度</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">LMSlist</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token class-name">LMSsublen</span><span class="token punctuation">[</span><span class="token class-name">LMSlist</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">LMSlist</span><span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token class-name">LMSlist</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//LMS 和 LMS 之间的长度是 LMS 子字符串的长度</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token class-name">LMSsublen</span><span class="token punctuation">[</span><span class="token class-name">LMSlist</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">// 最后一个 LMS 必须仅包含最后一个字符，其长度为 1。</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			sa <span class="token operator">=</span> <span class="token function">resetindex</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//4 步结束</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">LMSlist</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//第 1 步：添加学习管理系统</span>
				<span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token class-name">LMSlist</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
				sa<span class="token punctuation">[</span>str<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">addusirokara</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//从后面看时，继续在末尾添加值 = 从正面看并从后到前放置</span>
				used<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//我把它放在后缀数组中，所以我把它标记为已使用</span>
			<span class="token punctuation">}</span> <span class="token comment">//步骤 1 结束</span>
			sa <span class="token operator">=</span> <span class="token function">resetindex</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//重新计算数组索引</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sa<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//第 2 步：添加 L 形字母</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">int</span> value <span class="token operator">=</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> used<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">LS</span><span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						used<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
						sa<span class="token punctuation">[</span>str<span class="token punctuation">[</span>value<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">addmaekara</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//从前到后放置值</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			sa <span class="token operator">=</span> <span class="token function">resetindex</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3 步结束</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sa<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//3 个步骤</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">int</span> value <span class="token operator">=</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">LMS</span><span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//从后缀数组中删除 LMS</span>
						used<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//我从后缀数组中获取了LMS，因此它变得未使用</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span> <span class="token comment">//3 步结束</span>
			sa <span class="token operator">=</span> <span class="token function">resetindex</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//4 步结束</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> sa<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// 4 个步骤</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">int</span> index <span class="token operator">=</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> used<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">LS</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							sa<span class="token punctuation">[</span>str<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">addusirokara</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//从后到前放置值</span>
							used<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			sa <span class="token operator">=</span> <span class="token function">resetindex</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//4 步结束</span>
			<span class="token keyword">int</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nowsa <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 用于放置您现在正在查看的 LMS 子字符串的数组</span>
			<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> oldsa <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//包含上一个 LMS 子字符串的数组</span>
			<span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>oldsa<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">LMScounter</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>len<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sa<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//首先，不要搞错这里</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">LMS</span><span class="token punctuation">[</span>sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// 如果是 LMS，则 LMS 子字符串从那里开始</span>
						counter<span class="token operator">++</span><span class="token punctuation">;</span>
						<span class="token class-name">LMScounter</span><span class="token punctuation">[</span>sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> counter<span class="token punctuation">;</span>
						nowsa <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token class-name">LMSsublen</span><span class="token punctuation">[</span>sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// LMS 索引开始告知 LMS 子字符串的长度</span>
						<span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>nowsa<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						tmpindex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//LMS 子字符串索引</span>
						<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							nowsa<span class="token punctuation">[</span>tmpindex<span class="token punctuation">]</span> <span class="token operator">=</span> str<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
							tmpindex<span class="token operator">++</span><span class="token punctuation">;</span>
							<span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">!=</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">LMS</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
								<span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">//当下一个 LMS 到来时，LMS 子字符串已完成</span>
							<span class="token punctuation">}</span>
						<span class="token punctuation">}</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">equals</span><span class="token punctuation">(</span>oldsa<span class="token punctuation">,</span> nowsa<span class="token punctuation">)</span><span class="token comment">/* equals(oldsa, nowsa) */</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//如果您现在查看的 LMS 子字符串与上一个子字符串相同，请为同一子字符串分配相同的数字</span>
							counter<span class="token operator">--</span><span class="token punctuation">;</span>
							<span class="token class-name">LMScounter</span><span class="token punctuation">[</span>sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> counter<span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
						oldsa <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>nowsa<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> new_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token class-name">LMSlist</span><span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">LMSindex</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token class-name">LMSlist</span><span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">LMSlist</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//使用递归 SAIS 查找 LMS 子字符串的词典顺序</span>
				new_str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">LMScounter</span><span class="token punctuation">[</span><span class="token class-name">LMSlist</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token class-name">LMSindex</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">LMSlist</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> newLMSindex <span class="token operator">=</span> <span class="token function">SAIS</span><span class="token punctuation">(</span>new_str<span class="token punctuation">,</span> counter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			sa <span class="token operator">=</span> <span class="token function">resetindex</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>used<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 返回所有未使用</span>
			sa <span class="token operator">=</span> <span class="token function">clear</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 现在我们知道了新 LMS 子字符串的词典顺序，初始化后缀数组以将其重新放入</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> newLMSindex<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 新1段階目</span>
				<span class="token keyword">int</span> value <span class="token operator">=</span> <span class="token class-name">LMSindex</span><span class="token punctuation">[</span>newLMSindex<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				sa<span class="token punctuation">[</span>str<span class="token punctuation">[</span>value<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">addusirokara</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
				used<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			sa <span class="token operator">=</span> <span class="token function">resetindex</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//2 步 从现在开始，与上述 3 步和 4 步相同</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sa<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">int</span> value <span class="token operator">=</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> used<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">LS</span><span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						used<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
						sa<span class="token punctuation">[</span>str<span class="token punctuation">[</span>value<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">addmaekara</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			sa <span class="token operator">=</span> <span class="token function">resetindex</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2 个步骤结束</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sa<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// 2.5 步骤</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">int</span> value <span class="token operator">=</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">LMS</span><span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回</span>
						used<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span> <span class="token comment">//2.5 步骤结束</span>
			<span class="token comment">//3 个步骤</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> sa<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">int</span> index <span class="token operator">=</span> sa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> used<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">LS</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							sa<span class="token punctuation">[</span>str<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">addusirokara</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
							used<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			sa <span class="token operator">=</span> <span class="token function">resetindex</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3 个步骤结束</span>
			<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ret <span class="token operator">=</span> <span class="token function">convert</span><span class="token punctuation">(</span>sa<span class="token punctuation">,</span> len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//排除尾随字符索引</span>
			<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a1<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>a1<span class="token punctuation">.</span>length <span class="token operator">!=</span> a2<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a1<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>a1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> a2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">static</span> <span class="token constant">SA</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">resetindex</span><span class="token punctuation">(</span><span class="token constant">SA</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">resetindex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> a<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">static</span> <span class="token constant">SA</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token constant">SA</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> a<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">SA</span> <span class="token punctuation">{</span>
		<span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ary<span class="token punctuation">;</span>
		<span class="token keyword">private</span> <span class="token keyword">int</span> mae<span class="token punctuation">,</span> ato<span class="token punctuation">;</span>

		<span class="token function">SA</span><span class="token punctuation">(</span><span class="token keyword">int</span> volume<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			ary <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>volume<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>ary<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			mae <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			ato <span class="token operator">=</span> ary<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">void</span> <span class="token function">addmaekara</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>mae <span class="token operator">&lt;</span> ary<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				ary<span class="token punctuation">[</span>mae<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
				mae<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">void</span> <span class="token function">addusirokara</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ato <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				ary<span class="token punctuation">[</span>ato<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
				ato<span class="token operator">--</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">void</span> <span class="token function">resetindex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			mae <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			ato <span class="token operator">=</span> ary<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token keyword">int</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			ary<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">void</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>ary<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">resetindex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> ary<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> ary<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">static</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token constant">SA</span><span class="token punctuation">[</span><span class="token punctuation">]</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ret <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>len<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				ret<span class="token punctuation">[</span>counter<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
				counter<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ret <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>a<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			ret<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">&quot;aabaaaab&quot;</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token function">SAISENGINE</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> res<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br></div></div><h2 id="zstd差异化更新"><a href="#zstd差异化更新" class="header-anchor">#</a> ZSTD差异化更新</h2> <p>据测是</p></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2023-6-24 2:06:37 ├F10: AM┤</span></div></footer> <!----> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/./2022/10/08/%E5%B7%AE%E5%88%86%E7%AE%97%E6%B3%95/#前言" class="sidebar-link reco-side-前言" data-v-b57cc07c>前言</a></li><li class="level-3" data-v-b57cc07c><a href="/./2022/10/08/%E5%B7%AE%E5%88%86%E7%AE%97%E6%B3%95/#为何需要差异更新" class="sidebar-link reco-side-为何需要差异更新" data-v-b57cc07c>为何需要差异更新？</a></li><li class="level-3" data-v-b57cc07c><a href="/./2022/10/08/%E5%B7%AE%E5%88%86%E7%AE%97%E6%B3%95/#差异化更新方案有哪些" class="sidebar-link reco-side-差异化更新方案有哪些" data-v-b57cc07c>差异化更新方案有哪些？</a></li><li class="level-2" data-v-b57cc07c><a href="/./2022/10/08/%E5%B7%AE%E5%88%86%E7%AE%97%E6%B3%95/#bsdiff算法" class="sidebar-link reco-side-bsdiff算法" data-v-b57cc07c>bsdiff算法</a></li><li class="level-3" data-v-b57cc07c><a href="/./2022/10/08/%E5%B7%AE%E5%88%86%E7%AE%97%E6%B3%95/#bsdiff初认识" class="sidebar-link reco-side-bsdiff初认识" data-v-b57cc07c>bsdiff初认识</a></li><li class="level-3" data-v-b57cc07c><a href="/./2022/10/08/%E5%B7%AE%E5%88%86%E7%AE%97%E6%B3%95/#bsdiff基本步骤" class="sidebar-link reco-side-bsdiff基本步骤" data-v-b57cc07c>BSDiff基本步骤</a></li><li class="level-3" data-v-b57cc07c><a href="/./2022/10/08/%E5%B7%AE%E5%88%86%E7%AE%97%E6%B3%95/#bspatch基本步骤" class="sidebar-link reco-side-bspatch基本步骤" data-v-b57cc07c>BSPatch基本步骤</a></li><li class="level-3" data-v-b57cc07c><a href="/./2022/10/08/%E5%B7%AE%E5%88%86%E7%AE%97%E6%B3%95/#进一步优化方案" class="sidebar-link reco-side-进一步优化方案" data-v-b57cc07c>进一步优化方案：</a></li><li class="level-3" data-v-b57cc07c><a href="/./2022/10/08/%E5%B7%AE%E5%88%86%E7%AE%97%E6%B3%95/#使用方法" class="sidebar-link reco-side-使用方法" data-v-b57cc07c>使用方法</a></li><li class="level-3" data-v-b57cc07c><a href="/./2022/10/08/%E5%B7%AE%E5%88%86%E7%AE%97%E6%B3%95/#扩展-差分数组" class="sidebar-link reco-side-扩展-差分数组" data-v-b57cc07c>扩展：差分数组</a></li><li class="level-2" data-v-b57cc07c><a href="/./2022/10/08/%E5%B7%AE%E5%88%86%E7%AE%97%E6%B3%95/#zstd差异化更新" class="sidebar-link reco-side-zstd差异化更新" data-v-b57cc07c>ZSTD差异化更新</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----></div></div>
    <script src="./assets/js/app.764dede6.js" defer></script><script src="./assets/js/13.20e964b9.js" defer></script><script src="./assets/js/1.8757f81f.js" defer></script><script src="./assets/js/12.b32071c5.js" defer></script><script src="./assets/js/34.ec572062.js" defer></script>
  </body>
</html>
